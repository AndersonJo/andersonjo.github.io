---
layout: post
title:  "Presto Quick References"
date:   2023-02-01 01:00:00
categories: "sql"
asset_path: /assets/images/
tags: ['sql', 'table']
---


# 1. Quick References

## Create Table ... AS SELECT

```sql
CREATE TABLE IF NOT EXISTS schema.table_name
    WITH (
        format = 'parquet', 
        external_location = 's3://bucket/location/v0',
        partitioned_by = ARRAY['created_date']
      )
AS
    WITH temp_table AS (
        SELECT user_id, created_date
        FROM some.table_name_haha
      )

SELECT * 
FROM temp_table
```


## 2. INSERT INTO ... SELECT ...

```sql
INSERT INTO schema.table_name
WITH temp_table AS (
    SELECT user_id, created_date
    FROM some.table_name_haha
)

SELECT *
FROM temp_table
```